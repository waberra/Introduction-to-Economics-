<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Scarcity, Choice & Trade-offs - Canadian Economics</title>
  <style>
    body{
      font-family: Arial, sans-serif;
      max-width: 1200px;
      margin:0 auto;
      padding:20px;
      background: linear-gradient(135deg, #1a252f 0%, #2c3e50 100%);
      color:#333;
      min-height:100vh;
    }
    .container{
      background:#fff;
      padding:30px;
      border-radius:15px;
      box-shadow:0 4px 20px rgba(0,0,0,0.1);
      margin:20px 0;
    }
    h1{
      color:#2c3e50;
      text-align:center;
      margin-bottom:20px;
      font-size:2.4em;
    }
    .canada-header{
      background: linear-gradient(135deg, #ff0000, #ff6b6b);
      color:#fff;
      padding:20px;
      border-radius:10px;
      margin:20px 0;
      text-align:center;
    }
    .activity-nav{
      background:#343a40;
      padding:15px;
      border-radius:10px;
      margin:20px 0;
      text-align:center;
    }
    .nav-btn{
      background-color:#17a2b8;
      color:#fff;
      border:none;
      padding:12px 24px;
      margin:8px;
      border-radius:25px;
      cursor:pointer;
      font-size:1em;
      font-weight:bold;
      transition:all .3s ease;
    }
    .nav-btn:hover{ background-color:#138496; transform: translateY(-2px); }
    .nav-btn.active{ background-color:#28a745; }

    .activity-section{
      background: linear-gradient(135deg, #e3f2fd, #bbdefb);
      padding:25px;
      border-radius:10px;
      margin:20px 0;
      border:2px solid #2196f3;
      display:none;
    }
    .activity-section.active{ display:block; }

    .concept-box{
      background: linear-gradient(135deg, #fff8e1, #ffcc02);
      padding:20px;
      border-radius:10px;
      margin:20px 0;
      border:2px solid #ff6f00;
    }
    .scenario-box{
      background: linear-gradient(135deg, #e8f5e8, #c8e6c9);
      padding:20px;
      border-radius:10px;
      margin:20px 0;
      border:2px solid #4caf50;
    }
    .question-card{
      background:#fff;
      padding:20px;
      border-radius:10px;
      margin:15px 0;
      border:3px solid #2196f3;
      font-size:1.05em;
    }
    .choice-btn{
      background-color:#6f42c1;
      color:#fff;
      border:none;
      padding:10px 18px;
      margin:8px;
      border-radius:20px;
      cursor:pointer;
      font-size:.95em;
      font-weight:bold;
      transition:all .3s ease;
      min-width:170px;
    }
    .choice-btn:hover{ background-color:#5a32a3; transform: translateY(-1px); }
    .choice-btn.selected{ background-color:#28a745; }
    .choice-btn:disabled{
      opacity: 0.75;
      cursor: not-allowed;
      transform: none;
    }

    .feedback{
      margin:15px 0;
      padding:15px;
      border-radius:8px;
      font-weight:bold;
      display:none;
    }
    .feedback.correct{
      background-color:#d4edda;
      color:#155724;
      border:2px solid #c3e6cb;
    }
    .feedback.incorrect{
      background-color:#f8d7da;
      color:#721c24;
      border:2px solid #f5c6cb;
    }

    .progress-section{
      background:#f8f9fa;
      padding:15px;
      border-radius:8px;
      margin:20px 0;
      text-align:center;
    }
    .progress-bar{
      width:100%;
      height:20px;
      background-color:#e0e0e0;
      border-radius:10px;
      margin:15px 0;
    }
    .progress-fill{
      height:100%;
      background-color:#28a745;
      border-radius:10px;
      transition:width .3s ease;
    }

    .result-display{
      background: linear-gradient(135deg, #f3e5f5, #ce93d8);
      padding:20px;
      border-radius:10px;
      margin:20px 0;
      border:2px solid #9c27b0;
      display:none;
    }
    .score-display{
      background:#fff;
      padding:15px;
      border-radius:8px;
      margin:10px 0;
      text-align:center;
      font-size:1.2em;
      font-weight:bold;
    }

    .calculate-btn{
      background-color:#28a745;
      color:#fff;
      border:none;
      padding:10px 20px;
      margin:10px 5px;
      border-radius:20px;
      cursor:pointer;
      font-size:1em;
      font-weight:bold;
      transition:all .3s ease;
    }
    .calculate-btn:hover{ background-color:#218838; transform: translateY(-1px); }
    .calculate-btn.reset-btn{ background-color:#17a2b8; }
    .calculate-btn.reset-btn:hover{ background-color:#138496; }

    .small-note{ font-size:.95em; opacity:.9; margin-top:8px; }

    footer{
      margin-top:30px;
      padding-top:20px;
      border-top:2px dashed #cfd8dc;
      text-align:center;
    }

    @media (max-width: 768px){
      .container{ padding:15px; }
      h1{ font-size:2em; }
      .nav-btn{ padding:10px 18px; margin:5px; font-size:.9em; }
      .choice-btn{ min-width:150px; margin:5px; padding:8px 14px; }
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>üá®üá¶ Scarcity, Choice & Trade-offs</h1>

    <div class="canada-header">
      <h2>üçÅ The Big Idea: Resources are limited üçÅ</h2>
      <p><strong>Because of scarcity, every choice has a trade-off and an opportunity cost.</strong></p>
    </div>

    <!-- Navigation -->
    <div class="activity-nav">
      <button class="nav-btn active" onclick="showActivity('overview', this)">üîÑ Overview</button>
      <button class="nav-btn" onclick="showActivity('scarcity-spotter', this)">üîç Scarcity Spotter</button>
      <button class="nav-btn" onclick="showActivity('opportunity-cost', this)">‚öñÔ∏è Opportunity Cost</button>
      <button class="nav-btn" onclick="showActivity('quiz', this)">üéØ Master Quiz</button>
    </div>

    <!-- Overview -->
    <div id="overview" class="activity-section active">
      <h3>üîÑ Core Concepts</h3>

      <div class="concept-box">
        <h4>üìö Definitions</h4>
        <p><strong>Scarcity:</strong> Limited resources + unlimited wants. You can‚Äôt have everything.</p>
        <p><strong>Choice:</strong> Picking one option because you can‚Äôt pick all options.</p>
        <p><strong>Trade-off:</strong> What you give up when you choose something else.</p>
        <p><strong>Opportunity cost:</strong> The <em>next best alternative</em> you give up.</p>
        <p class="small-note"><strong>Shortcut:</strong> Scarcity ‚Üí Choice ‚Üí Trade-off ‚Üí Opportunity Cost</p>
      </div>

      <div class="scenario-box">
        <h4>üçÅ Canadian Example: City Budget</h4>
        <p>A city can spend extra money on <strong>transit</strong> or <strong>parks</strong>, but not both at the same level.</p>
        <p class="small-note"><em>If transit is chosen, the opportunity cost might be parks (if parks was the next best choice).</em></p>
      </div>
    </div>

    <!-- Scarcity Spotter (UPDATED: 20 questions, neutral buttons, reset = new set) -->
    <div id="scarcity-spotter" class="activity-section">
      <h3>üîç Scarcity Spotter</h3>

      <div class="concept-box">
        <h4>üéØ Goal</h4>
        <p>Decide if each situation shows <strong>scarcity</strong>. (No hints on the buttons!)</p>
        <p class="small-note"><em>Tip:</em> If a resource is limited and people want more of it, that‚Äôs scarcity.</p>
      </div>

      <div class="progress-section">
        <h4>üìä Progress Tracker</h4>
        <div id="spotter-progress">Answered: <span id="spotter-done">0</span>/<span id="spotter-total">20</span></div>
        <div class="progress-bar">
          <div id="spotter-fill" class="progress-fill" style="width:0%;"></div>
        </div>
        <button class="calculate-btn reset-btn" onclick="resetSpotter()">üîÑ Reset (New 20 Questions)</button>
      </div>

      <div id="spotter-container"></div>

      <div id="spotter-results" class="result-display">
        <h4>üéØ Scarcity Spotter Results</h4>
        <div id="spotter-score" class="score-display"></div>
        <div id="spotter-review"></div>
      </div>
    </div>

    <!-- Opportunity Cost -->
    <div id="opportunity-cost" class="activity-section">
      <h3>‚öñÔ∏è Opportunity Cost Builder</h3>

      <div class="concept-box">
        <h4>üéØ Goal</h4>
        <p>Pick the <strong>opportunity cost</strong> (the next best alternative) for each choice.</p>
      </div>

      <div class="question-card">
        <p><strong>1) You have one evening. You choose to work a shift instead of going to a Raptors game.</strong><br>
        <em>What is the opportunity cost?</em></p>
        <button class="choice-btn" onclick="checkMC('oc1', 0, 1, 'Not quite. Wages are what you gain, not what you give up.', this)">The wages you earn</button>
        <button class="choice-btn" onclick="checkMC('oc1', 1, 1, 'Correct! The next best alternative you give up is the Raptors game.', this)">Going to the Raptors game</button>
        <button class="choice-btn" onclick="checkMC('oc1', 2, 1, 'That‚Äôs a result, but not the next best alternative.', this)">Feeling tired after work</button>
        <div id="oc1-feedback" class="feedback"></div>
      </div>

      <div class="question-card">
        <p><strong>2) A school can buy new laptops OR upgrade the gym floor. It chooses laptops.</strong><br>
        <em>What is the opportunity cost?</em></p>
        <button class="choice-btn" onclick="checkMC('oc2', 0, 2, 'Not quite. Laptops are what was chosen, not the opportunity cost.', this)">New laptops</button>
        <button class="choice-btn" onclick="checkMC('oc2', 1, 2, 'That‚Äôs a limit, but not the next best alternative.', this)">The school budget</button>
        <button class="choice-btn" onclick="checkMC('oc2', 2, 2, 'Correct! The next best alternative is the gym floor upgrade.', this)">Upgrading the gym floor</button>
        <div id="oc2-feedback" class="feedback"></div>
      </div>

      <div class="scenario-box">
        <h4>üß† Fast Rule</h4>
        <p><strong>Opportunity cost</strong> is the <strong>one best alternative</strong> you would have chosen next.</p>
      </div>
    </div>

    <!-- Master Quiz -->
    <div id="quiz" class="activity-section">
      <h3>üéØ Scarcity, Choice & Trade-offs Master Quiz</h3>

      <div class="progress-section">
        <h4>üìä Progress Tracker</h4>
        <div id="quiz-progress">Questions Completed: <span id="completed-count">0</span>/<span id="total-count">12</span></div>
        <div class="progress-bar">
          <div id="quiz-progress-fill" class="progress-fill" style="width:0%;"></div>
        </div>
        <!-- UPDATED: Reset now immediately gives a new set (no confirm) -->
        <button class="calculate-btn reset-btn" onclick="resetMasterQuiz()">üîÑ Reset (New Questions)</button>
      </div>

      <div id="master-quiz"></div>

      <div class="result-display" id="final-results" style="display:none;">
        <h4>üéØ Quiz Results</h4>
        <div id="score-summary" class="score-display"></div>
        <div id="detailed-feedback"></div>
      </div>
    </div>

    <!-- Footer: clickable website always -->
    <footer>
      <p style="font-weight:bold;">
        ‚úÖ View this interactive module online:
        <a href="https://htmlpreview.github.io/?https://github.com/waberra/Introduction-to-Economics-/blob/main/Scarcity.html"
           target="_blank" rel="noopener noreferrer">
          Click here
        </a>
      </p>
      <p class="small-note">
        GitHub Pages version (if enabled):
        <strong>https://waberra.github.io/Introduction-to-Economics-/Scarcity.html</strong>
      </p>
    </footer>
  </div>

  <script>
    // ---------- Navigation ----------
    function showActivity(activityId, btn) {
      document.querySelectorAll(".activity-section").forEach(s => s.classList.remove("active"));
      document.querySelectorAll(".nav-btn").forEach(b => b.classList.remove("active"));
      document.getElementById(activityId).classList.add("active");
      btn.classList.add("active");

      // Auto-init sections when opened
      if (activityId === "scarcity-spotter") initializeSpotter();
      if (activityId === "quiz") initializeMasterQuiz();
    }

    // ---------- Shared UI helpers ----------
    function markSelected(btn) {
      const parent = btn.parentElement;
      parent.querySelectorAll(".choice-btn").forEach(b => b.classList.remove("selected"));
      btn.classList.add("selected");
    }

    function showFeedback(id, isCorrect, text) {
      const div = document.getElementById(id + "-feedback");
      div.style.display = "block";
      div.className = isCorrect ? "feedback correct" : "feedback incorrect";
      div.textContent = text;
    }

    // Multiple choice checker (Opportunity Cost section)
    function checkMC(id, selectedIndex, correctIndex, msg, btn) {
      markSelected(btn);
      showFeedback(id, selectedIndex === correctIndex, msg);
    }

    // ---------- Scarcity Spotter (UPDATED) ----------
    const SPOTTER_COUNT = 20;

    const spotterBank = [
      { prompt: "A concert in Toronto sells out because there are only 18,000 seats.", scarce: true, explain: "Seats/capacity are limited, so the venue resource is scarce." },
      { prompt: "A student wants 10 new apps, but their phone storage is almost full.", scarce: true, explain: "Storage space is limited, forcing choices." },
      { prompt: "A website offers unlimited downloads of a free digital wallpaper (copies can be made endlessly).", scarce: false, explain: "In this simplified example, the copy itself isn‚Äôt limited (though access/time/devices can be scarce)." },
      { prompt: "A hockey team has only a few roster spots for goalies.", scarce: true, explain: "Roster positions are limited." },
      { prompt: "A restaurant has only 4 cooks during a dinner rush.", scarce: true, explain: "Worker time/capacity is limited." },

      { prompt: "A library has only 2 copies of a popular book and many students want it.", scarce: true, explain: "Copies available now are limited." },
      { prompt: "A school has 10 chromebooks for a class of 28 students.", scarce: true, explain: "Devices are limited compared to demand." },
      { prompt: "A city has a limited number of snowplows during a big storm.", scarce: true, explain: "Equipment/time is limited, so not all roads can be cleared at once." },
      { prompt: "A food truck has only 40 meals prepared for lunch hour.", scarce: true, explain: "Meals available are limited." },
      { prompt: "A bus has a maximum number of seats during morning commute.", scarce: true, explain: "Seat capacity is limited." },

      { prompt: "A park has only 3 picnic shelters that can be booked for the same Saturday.", scarce: true, explain: "Booking slots are limited." },
      { prompt: "A student has unlimited time after school every day.", scarce: false, explain: "Time is generally limited‚Äîthis statement says unlimited, so in this simplified case it‚Äôs not scarcity." },
      { prompt: "A community center has 25 spots in a swim class, but 60 people want in.", scarce: true, explain: "Class spots are limited." },
      { prompt: "A store runs a 'first 50 customers' deal for free jerseys.", scarce: true, explain: "The free items are limited." },
      { prompt: "A farm has limited water during a drought and must ration irrigation.", scarce: true, explain: "Water is limited, forcing choices." },

      { prompt: "A student can print unlimited pages for free with no limits.", scarce: false, explain: "In this simplified model, if it‚Äôs truly unlimited/free, it‚Äôs not scarce (though real printing usually is)." },
      { prompt: "A music festival has limited camping sites near the stage.", scarce: true, explain: "Space close to the stage is limited." },
      { prompt: "A hospital has limited ICU beds during a flu season surge.", scarce: true, explain: "Beds and staff capacity are limited." },
      { prompt: "A gaming tournament has only 16 team slots in the bracket.", scarce: true, explain: "Tournament entry slots are limited." },
      { prompt: "A town has one bridge under repair, reducing lanes and causing traffic.", scarce: true, explain: "Road capacity (lanes/time) is limited." },

      { prompt: "A bakery has unlimited ovens that can bake endlessly with no cost.", scarce: false, explain: "The statement says unlimited/no cost, so in this simplified model it‚Äôs not scarcity." },
      { prompt: "There are only so many hours in a day to study, work, and relax.", scarce: true, explain: "Time is limited." },
      { prompt: "A local rink has limited ice time for teams during prime hours.", scarce: true, explain: "Prime booking times are limited." },
      { prompt: "A streaming platform has unlimited digital copies of a show, but you must choose what to watch tonight.", scarce: true, explain: "The scarce resource is time/attention, not the copies." },
      { prompt: "A school cafeteria has limited tables at lunch, so some students stand.", scarce: true, explain: "Seating space is limited." }
    ];

    let spotterSet = [];
    let spotterState = {}; // id -> { answered, correct, selected }
    let spotterDone = 0;
    let spotterScore = 0;

    function shuffle(arr){
      const a = [...arr];
      for (let i = a.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [a[i], a[j]] = [a[j], a[i]];
      }
      return a;
    }

    function pickN(arr, n){
      return shuffle(arr).slice(0, n);
    }

    function initializeSpotter(){
      spotterSet = pickN(spotterBank, SPOTTER_COUNT);
      spotterState = {};
      spotterDone = 0;
      spotterScore = 0;

      document.getElementById("spotter-results").style.display = "none";
      document.getElementById("spotter-done").textContent = "0";
      document.getElementById("spotter-total").textContent = String(SPOTTER_COUNT);
      document.getElementById("spotter-fill").style.width = "0%";

      renderSpotter();
    }

    // UPDATED: reset gives new 20 questions immediately
    function resetSpotter(){
      initializeSpotter();
    }

    function renderSpotter(){
      const container = document.getElementById("spotter-container");
      container.innerHTML = spotterSet.map((q, idx) => {
        const qid = "spotter" + idx;
        return `
          <div class="question-card" id="${qid}">
            <p><strong>${idx + 1}) ${q.prompt}</strong></p>
            <button class="choice-btn" onclick="answerSpotter(${idx}, true, this)">Scarcity</button>
            <button class="choice-btn" onclick="answerSpotter(${idx}, false, this)">Not Scarcity</button>
            <div id="${qid}-feedback" class="feedback"></div>
          </div>
        `;
      }).join("");
    }

    function answerSpotter(index, choice, btn){
      const q = spotterSet[index];
      const qid = "spotter" + index;

      // prevent double scoring
      if (spotterState[qid]?.answered) return;

      const isCorrect = choice === q.scarce;
      spotterState[qid] = { answered:true, correct:isCorrect, selected:choice };

      if (isCorrect) spotterScore++;
      spotterDone++;

      // lock buttons in that card
      const card = document.getElementById(qid);
      const buttons = card.querySelectorAll("button.choice-btn");
      buttons.forEach(b => b.disabled = true);

      // visually mark selection
      btn.classList.add("selected");

      // feedback
      const fb = document.getElementById(qid + "-feedback");
      fb.style.display = "block";
      fb.className = isCorrect ? "feedback correct" : "feedback incorrect";
      fb.textContent = (isCorrect ? "Correct. " : "Incorrect. ") + q.explain;

      // progress update
      document.getElementById("spotter-done").textContent = String(spotterDone);
      document.getElementById("spotter-fill").style.width = (spotterDone / SPOTTER_COUNT) * 100 + "%";

      // finish
      if (spotterDone === SPOTTER_COUNT) showSpotterResults();
    }

    function showSpotterResults(){
      const pct = Math.round((spotterScore / SPOTTER_COUNT) * 100);
      document.getElementById("spotter-results").style.display = "block";
      document.getElementById("spotter-score").innerHTML =
        `Your Score: ${spotterScore}/${SPOTTER_COUNT} (${pct}%)`;

      // quick review summary
      let review = "<h5>üìã Quick Review:</h5>";
      spotterSet.forEach((q, idx) => {
        const st = spotterState["spotter"+idx];
        const got = st?.correct ? "‚úÖ" : "‚ùå";
        const correctLabel = q.scarce ? "Scarcity" : "Not Scarcity";
        review += `
          <div style="margin:10px 0; padding:12px; border-radius:8px; background:#ffffff; border:1px solid #dee2e6;">
            <strong>${got} #${idx + 1}</strong> ‚Äî Correct answer: <strong>${correctLabel}</strong><br>
            <em>${q.explain}</em>
          </div>
        `;
      });
      document.getElementById("spotter-review").innerHTML = review;
    }

    // ---------- Master Quiz (Reset changed: no confirm, new set) ----------
    let currentQ = 0;
    let answers = [];
    let score = 0;
    let quizQuestions = [];

    const questionBank = [
      { q: "Scarcity means:", options: ["Resources are unlimited","Wants are limited","Resources are limited compared to wants","Prices are always high"], correct: 2,
        exp:"Scarcity is when limited resources meet unlimited wants." },
      { q: "Because of scarcity, people must:", options: ["Avoid all choices","Make choices","Get everything they want","Stop producing goods"], correct: 1,
        exp:"Scarcity forces choices." },
      { q: "A trade-off is:", options: ["A free bonus","What you give up when you choose something","Always money spent","Only for businesses"], correct: 1,
        exp:"A trade-off is what you give up due to a choice." },
      { q: "Opportunity cost is:", options: ["Total cost in dollars","The next best alternative you give up","All alternatives you give up","Something you gain"], correct: 1,
        exp:"Opportunity cost is the next best alternative sacrificed." },
      { q: "You study instead of playing video games. If games were next best, opportunity cost is:", options: ["Studying","Video games","Your grades","Your phone"], correct: 1,
        exp:"You gave up video games (next best alternative)." },
      { q: "A sold-out arena is scarcity of:", options: ["Hockey","Seats (capacity)","Fans","Weather"], correct: 1,
        exp:"Seats/capacity are limited." },
      { q: "Funding more hospitals means less for highways. This shows:", options: ["Scarcity and trade-offs","Only profits","No need for choices","Unlimited resources"], correct: 0,
        exp:"Limited funds force choices and trade-offs." },
      { q: "Opportunity cost depends on:", options: ["Always money","Always time","Your next best alternative","The chosen option"], correct: 2,
        exp:"It depends on what you would have chosen next." },
      { q: "If your budget is fixed, spending more in one category means:", options: ["Nothing changes","Other categories must decrease or you go over budget","Income doubles","Scarcity disappears"], correct: 1,
        exp:"Fixed budgets create trade-offs." },
      { q: "Choosing shoes instead of a hoodie is an example of:", options: ["Scarcity only","A trade-off","No choice","A surplus"], correct: 1,
        exp:"You give up the hoodie to get the shoes." },
      { q: "Scarcity exists because:", options: ["People don‚Äôt want much","Resources are limited and wants are unlimited","All goods are free","Everyone earns the same income"], correct: 1,
        exp:"Limited resources + unlimited wants." },
      { q: "Opportunity cost is closest to:", options: ["The chosen option","All options","The next best alternative","The price tag only"], correct: 2,
        exp:"It‚Äôs the next best alternative you give up." },
      // extras for variety
      { q: "A limited number of camp sites at a festival is scarcity of:", options: ["Music","Space","Videos","Friendships"], correct: 1, exp:"Space is limited." },
      { q: "If copies of a free digital file are unlimited, the file itself is (simplified):", options: ["Scarce","Not scarce","Always expensive","Only scarce for businesses"], correct: 1,
        exp:"Unlimited copies means the item itself isn‚Äôt scarce (in this simplified model)." }
    ];

    function pickQuestions(n){
      return shuffle(questionBank).slice(0, n);
    }

    // UPDATED: no confirm
    function resetMasterQuiz(){
      initializeMasterQuiz();
    }

    function initializeMasterQuiz(){
      currentQ = 0;
      answers = [];
      score = 0;
      quizQuestions = pickQuestions(12);

      document.getElementById("final-results").style.display = "none";
      document.getElementById("completed-count").textContent = "0";
      document.getElementById("total-count").textContent = String(quizQuestions.length);
      document.getElementById("quiz-progress-fill").style.width = "0%";

      displayQuestion();
    }

    function displayQuestion(){
      if (currentQ >= quizQuestions.length) return showResults();

      const q = quizQuestions[currentQ];
      const container = document.getElementById("master-quiz");

      container.innerHTML = `
        <div class="question-card">
          <h5>Question ${currentQ + 1} of ${quizQuestions.length}</h5>
          <p><strong>${q.q}</strong></p>
          <div id="q-options">
            ${q.options.map((opt, idx) =>
              `<button class="choice-btn" onclick="answerQuiz(${idx}, this)">${opt}</button>`
            ).join("")}
          </div>
          <div id="q-feedback" class="feedback"></div>
        </div>
      `;
    }

    function answerQuiz(selectedIndex, btn){
      const q = quizQuestions[currentQ];
      const isCorrect = selectedIndex === q.correct;

      answers[currentQ] = {
        question: q.q,
        options: q.options,
        selected: selectedIndex,
        correct: q.correct,
        isCorrect,
        explanation: q.exp
      };

      if (isCorrect) score++;

      // lock buttons
      btn.parentElement.querySelectorAll(".choice-btn").forEach(b => b.disabled = true);
      btn.classList.add("selected");

      const feedback = document.getElementById("q-feedback");
      feedback.style.display = "block";
      feedback.className = isCorrect ? "feedback correct" : "feedback incorrect";
      feedback.innerHTML = `<strong>${isCorrect ? "Correct!" : "Incorrect."}</strong><br>${q.exp}`;

      // progress
      const completed = currentQ + 1;
      document.getElementById("completed-count").textContent = String(completed);
      document.getElementById("quiz-progress-fill").style.width = (completed / quizQuestions.length) * 100 + "%";

      setTimeout(() => {
        currentQ++;
        displayQuestion();
      }, 2200);
    }

    function showResults(){
      const total = quizQuestions.length;
      const pct = Math.round((score / total) * 100);

      const resultsDiv = document.getElementById("final-results");
      const scoreDiv = document.getElementById("score-summary");
      const detailDiv = document.getElementById("detailed-feedback");

      scoreDiv.innerHTML = `Your Score: ${score}/${total} (${pct}%)`;

      let html = "<h5>üìã Detailed Review:</h5>";
      answers.forEach((a, i) => {
        html += `
          <div style="margin: 12px 0; padding: 12px; border-radius: 8px; ${a.isCorrect ? "background:#d4edda;border:2px solid #c3e6cb;" : "background:#f8d7da;border:2px solid #f5c6cb;"}">
            <strong>Q${i+1}:</strong> ${a.question}<br>
            <strong>Your answer:</strong> ${a.options[a.selected]}<br>
            <strong>Correct answer:</strong> ${a.options[a.correct]}<br>
            <em>${a.explanation}</em>
          </div>
        `;
      });

      detailDiv.innerHTML = html;
      resultsDiv.style.display = "block";
    }
  </script>
</body>
</html>
