<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Absolute & Comparative Advantage Interactive Learning</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body {
      font-family: "Trebuchet MS", sans-serif;
      padding: 20px;
      background: #fde3d9; /* peach background */
      background-image: linear-gradient(
        to bottom,
        rgba(255, 255, 255, 0.7) 1px,
        transparent 1px
      );
      background-size: 100% 32px;
      display: flex;
      justify-content: center;
      color: #143057; /* deep navy text */
      box-sizing: border-box;
    }

    .container {
      max-width: 1200px;
      width: 100%;
    }

    /* Coral Red Header Card */
    .header-box {
      background: #ff4d6d;           /* coral red */
      color: #ffffff;
      padding: 20px;
      border-radius: 16px;
      box-shadow: 0 4px 12px rgba(20, 48, 87, 0.35);
      margin-bottom: 20px;
      border: 3px solid #ffffff;
    }
    .header-box h1 {
      margin: 0 0 10px 0;
      color: #ffffff;
      text-align: center;
    }
    .header-box p {
      margin: 0;
      text-align: center;
    }

    /* Light Blue Explanation Card */
    .explanation-box {
      background: #e8f4fd;           /* light blue */
      color: #143057;
      padding: 20px;
      border-radius: 16px;
      box-shadow: 0 4px 12px rgba(20, 48, 87, 0.2);
      margin-bottom: 20px;
      border: 2px solid #4a90e2;
    }
    
    .explanation-box h2 {
      margin: 0 0 20px 0;
      color: #2c5282;
      text-align: center;
      border-bottom: 2px solid #4a90e2;
      padding-bottom: 10px;
    }

    .concepts-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 15px;
      margin: 20px 0;
    }

    .concept-item {
      margin: 10px 0;
      padding: 15px;
      background: #ffffff;
      border-radius: 10px;
      border-left: 4px solid #4a90e2;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
    
    .concept-item h3 {
      margin: 0 0 10px 0;
      color: #2c5282;
      font-size: 1.1em;
    }
    
    .concept-item .definition {
      font-weight: bold;
      margin-bottom: 8px;
      color: #143057;
    }
    
    .concept-item .formula {
      background: #f0f8ff;
      padding: 8px;
      border-radius: 5px;
      font-family: 'Courier New', monospace;
      margin: 8px 0;
      text-align: center;
      border: 1px solid #4a90e2;
    }

    .concept-item .example {
      font-style: italic;
      color: #666;
      margin-top: 8px;
      font-size: 0.9em;
    }

    /* Production Tables */
    .production-table {
      width: 100%;
      border-collapse: collapse;
      margin: 15px 0;
      background: white;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      border-radius: 8px;
      overflow: hidden;
    }

    .production-table th {
      background: #ff4d6d;           /* coral red header */
      color: white;
      padding: 12px;
      text-align: center;
      font-weight: bold;
    }

    .production-table td {
      padding: 10px;
      text-align: center;
      border-bottom: 1px solid #e0e0e0;
    }

    .production-table tr:nth-child(even) {
      background: #f8f9fa;
    }

    .production-table tr:hover {
      background: #fde3d9;          /* light peach hover */
    }

    .highlight-advantage {
      background: #d4edda !important;
      font-weight: bold;
      color: #155724;
    }

    .trade-comparison {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
      margin: 20px 0;
    }

    .trade-scenario {
      background: rgba(255,255,255,0.8);
      padding: 15px;
      border-radius: 10px;
      border: 2px solid #ffc107;
    }

    /* Aqua Question Card */
    #question-card {
      margin: 12px 0;
      padding: 25px;
      background: #a6f5e9;           /* aqua pastel */
      border: 3px solid #46cbb0;     /* teal border */
      border-radius: 16px;
      box-shadow: 0 0 10px rgba(70, 203, 176, 0.45);
      display: none;
      color: #143057;                /* navy text inside card */
    }

    #question-text {
      font-weight: bold;
      margin-bottom: 20px;
      font-size: 1.2em;
      line-height: 1.4;
    }

    #progress {
      font-size: 1em;
      margin-bottom: 15px;
      text-align: center;
      background: rgba(255,255,255,0.7);
      padding: 8px;
      border-radius: 8px;
      font-weight: bold;
    }

    .options {
      margin: 20px 0;
    }
    
    .options label {
      display: block;
      margin: 12px 0;
      cursor: pointer;
      color: #143057;
      padding: 15px;
      background: rgba(255,255,255,0.6);
      border-radius: 8px;
      transition: all 0.2s;
      border: 2px solid transparent;
      font-size: 1.05em;
    }
    
    .options label:hover {
      background: rgba(255,255,255,0.8);
      border-color: #46cbb0;
      transform: translateY(-1px);
    }
    
    .options input {
      margin-right: 12px;
      transform: scale(1.3);
    }

    .input-field {
      padding: 8px;
      border: 2px solid #46cbb0;
      border-radius: 5px;
      text-align: center;
      font-size: 1em;
      margin: 5px;
      width: 120px;
    }

    .scenario-box {
      background: #fff3cd;
      border: 2px solid #ffc107;
      padding: 15px;
      border-radius: 8px;
      margin: 15px 0;
    }

    #warning {
      font-size: 0.95em;
      color: #e8113b;                /* cherry red */
      min-height: 1.2em;
      margin: 15px 0;
      text-align: center;
      font-weight: bold;
      background: rgba(232, 17, 59, 0.1);
      padding: 8px;
      border-radius: 5px;
    }

    /* Feedback Section */
    #feedback-section {
      margin-top: 20px;
      padding: 20px;
      border-radius: 12px;
      display: none;
      animation: slideIn 0.4s ease-out;
    }
    
    @keyframes slideIn {
      from { opacity: 0; transform: translateY(-20px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    .feedback-correct {
      background: #d4edda;
      border: 3px solid #1ccb8f;     /* ocean green */
      color: #155724;
    }
    
    .feedback-incorrect {
      background: #f8d7da;
      border: 3px solid #e8113b;     /* cherry red */
      color: #721c24;
    }
    
    .feedback-header {
      font-weight: bold;
      font-size: 1.4em;
      margin-bottom: 15px;
      text-align: center;
    }
    
    .feedback-explanation {
      margin-top: 15px;
      font-size: 1.1em;
      line-height: 1.5;
    }

    .feedback-details {
      margin-top: 15px;
      padding: 12px;
      background: rgba(255,255,255,0.4);
      border-radius: 8px;
      font-size: 1em;
    }

    /* Score Display */
    #score-display {
      background: #fff3cd;
      border: 2px solid #ffc107;
      color: #856404;
      padding: 15px;
      border-radius: 10px;
      margin: 15px 0;
      text-align: center;
      font-weight: bold;
      display: none;
    }

    /* Buttons */
    .buttons {
      margin-top: 25px;
      display: flex;
      gap: 15px;
      flex-wrap: wrap;
      justify-content: center;
    }
    
    button {
      padding: 14px 24px;
      border-radius: 10px;
      border: none;
      cursor: pointer;
      font-size: 1em;
      font-weight: bold;
      transition: all 0.3s;
      box-shadow: 0 0 10px rgba(109, 252, 155, 0.6);
      min-width: 160px;
    }
    
    .btn-primary {
      background: #6dfc9b;           /* mint green */
      color: #143057;                /* navy text */
    }
    .btn-primary:hover {
      background: #82ffd6;
      box-shadow: 0 0 14px rgba(130, 255, 214, 0.8);
      transform: translateY(-2px);
    }

    .btn-secondary {
      background: #a6f5e9;           /* aqua */
      color: #143057;
    }
    .btn-secondary:hover {
      background: #8eeee4;
      box-shadow: 0 0 14px rgba(142, 238, 228, 0.8);
      transform: translateY(-2px);
    }

    .btn-warning {
      background: #ffc107;           /* yellow */
      color: #143057;
    }
    .btn-warning:hover {
      background: #ffcd39;
      box-shadow: 0 0 14px rgba(255, 205, 57, 0.8);
      transform: translateY(-2px);
    }

    .btn-danger {
      background: #ff4d6d;           /* coral red */
      color: #ffffff;
    }
    .btn-danger:hover {
      background: #ff6b85;
      box-shadow: 0 0 14px rgba(255, 107, 133, 0.8);
      transform: translateY(-2px);
    }

    .hidden {
      display: none;
    }

    /* Responsive Design */
    @media (max-width: 768px) {
      body {
        padding: 12px;
      }
      .buttons {
        flex-direction: column;
      }
      button {
        width: 100%;
        min-width: unset;
      }
      .concepts-grid {
        grid-template-columns: 1fr;
      }
      .trade-comparison {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>

<body>
  <div class="container">

    <div class="header-box">
      <h1>üåç Absolute & Comparative Advantage Learning</h1>
      <p>
        Master international trade principles, opportunity costs, and gains from specialization<br>
        with interactive Canadian trade scenarios!
      </p>
    </div>

    <!-- Concepts Explanation -->
    <div class="explanation-box">
      <h2>üìö Trade Advantage Concepts</h2>
      
      <div class="concepts-grid">
        <div class="concept-item">
          <h3>üèÜ Absolute Advantage</h3>
          <div class="definition">The ability to produce more of a good than competitors using the same resources.</div>
          <div class="formula">Absolute Advantage = Higher Production Output</div>
          <div class="example">Example: Canada produces 100 cars vs Mexico's 60 cars with same resources</div>
        </div>

        <div class="concept-item">
          <h3>‚öñÔ∏è Comparative Advantage</h3>
          <div class="definition">The ability to produce a good at a lower opportunity cost than competitors.</div>
          <div class="formula">Comparative Advantage = Lower Opportunity Cost</div>
          <div class="example">Example: Canada's opportunity cost of 1 car = 2 wheat vs Mexico's 3 wheat</div>
        </div>

        <div class="concept-item">
          <h3>üí∞ Opportunity Cost Calculation</h3>
          <div class="definition">What must be given up to produce one more unit of a good.</div>
          <div class="formula">Opportunity Cost = What you give up √∑ What you gain</div>
          <div class="example">Example: To get 1 more car, Canada gives up 2 wheat (OC = 2 wheat)</div>
        </div>

        <div class="concept-item">
          <h3>üîÑ Gains from Trade</h3>
          <div class="definition">Benefits both countries receive by specializing and trading.</div>
          <div class="formula">Mutual Benefits from Specialization</div>
          <div class="example">Example: Both countries consume more through trade than in isolation</div>
        </div>

        <div class="concept-item">
          <h3>üéØ Specialization</h3>
          <div class="definition">Focusing production on goods where you have comparative advantage.</div>
          <div class="formula">Specialize in Lower Opportunity Cost Good</div>
          <div class="example">Example: Canada specializes in wheat, Mexico in cars</div>
        </div>

        <div class="concept-item">
          <h3>üìä Terms of Trade</h3>
          <div class="definition">The exchange rate between goods that makes trade beneficial for both parties.</div>
          <div class="formula">Acceptable Range: Between Both Opportunity Costs</div>
          <div class="example">Example: 1 car trades for 2.5 wheat (between Canada's 2 and Mexico's 3)</div>
        </div>

        <div class="concept-item">
          <h3>üåê Production Possibilities</h3>
          <div class="definition">Maximum combinations of goods each country can produce alone.</div>
          <div class="formula">Resources √ó Productivity = Maximum Output</div>
          <div class="example">Example: Canada can produce 100 cars OR 200 wheat with all resources</div>
        </div>

        <div class="concept-item">
          <h3>üçÉ Consumption Possibilities</h3>
          <div class="definition">Combinations of goods each country can consume through trade.</div>
          <div class="formula">Specialization + Trade > Autarky Production</div>
          <div class="example">Example: Canada consumes 120 cars + 150 wheat through trade</div>
        </div>

        <div class="concept-item">
          <h3>ü§ù Mutually Beneficial Trade</h3>
          <div class="definition">When both countries gain more than they could produce in isolation.</div>
          <div class="formula">Win-Win Through Comparative Advantage</div>
          <div class="example">Example: Both countries consume beyond their individual PPCs</div>
        </div>
      </div>
    </div>

    <!-- Score Display -->
    <div id="score-display"></div>

    <!-- Question Card -->
    <div id="question-card">
      <div id="progress"></div>
      <div id="question-text"></div>
      <div id="trade-scenario-display"></div>
      <div id="question-input-area"></div>
      <div id="warning"></div>

      <!-- Feedback Section -->
      <div id="feedback-section">
        <div class="feedback-header" id="feedback-header"></div>
        <div class="feedback-explanation" id="feedback-explanation"></div>
        <div class="feedback-details" id="feedback-details"></div>
      </div>
    </div>

    <!-- Control Buttons -->
    <div class="buttons">
      <button id="start-btn" class="btn-primary" onclick="startLearning()">üöÄ Start Learning</button>
      <button id="show-explanation-btn" class="btn-secondary hidden" onclick="showExplanation()">üí° Show Explanation</button>
      <button id="check-answer-btn" class="btn-warning hidden" onclick="checkAnswer()">‚úÖ Check Answer</button>
      <button id="next-btn" class="btn-primary hidden" onclick="nextQuestion()">‚û°Ô∏è Next Question</button>
      <button id="reset-btn" class="btn-danger hidden" onclick="resetLearning()">üîÑ Reset & New Scenario</button>
    </div>

  </div>

<script>
  // Trade Scenarios with Canadian contexts
  const tradeScenarios = [
    {
      title: "Canada vs. United States: Wheat & Cars",
      description: "Trade relationship between Canada and the US in agricultural and automotive sectors",
      country1: {
        name: "Canada", 
        good1: {name: "Wheat", production: 200},
        good2: {name: "Cars", production: 100}
      },
      country2: {
        name: "United States",
        good1: {name: "Wheat", production: 150}, 
        good2: {name: "Cars", production: 180}
      },
      context: "NAFTA trade relationship with complementary strengths",
      timeframe: "Annual production with same resources"
    },
    {
      title: "Canada vs. Japan: Lumber & Electronics", 
      description: "Pacific trade between Canada and Japan in natural resources vs high-tech",
      country1: {
        name: "Canada",
        good1: {name: "Lumber", production: 300},
        good2: {name: "Electronics", production: 50}
      },
      country2: {
        name: "Japan", 
        good1: {name: "Lumber", production: 80},
        good2: {name: "Electronics", production: 240}
      },
      context: "Resource-rich Canada vs technology-advanced Japan",
      timeframe: "Annual production with identical resources"
    },
    {
      title: "Alberta vs. Ontario: Oil & Manufacturing",
      description: "Interprovincial trade between resource-rich Alberta and manufacturing Ontario", 
      country1: {
        name: "Alberta",
        good1: {name: "Oil", production: 400},
        good2: {name: "Manufactured Goods", production: 120}
      },
      country2: {
        name: "Ontario",
        good1: {name: "Oil", production: 50}, 
        good2: {name: "Manufactured Goods", production: 300}
      },
      context: "Canadian interprovincial resource and manufacturing trade",
      timeframe: "Annual production capacity with equivalent resources"
    },
    {
      title: "Canada vs. Mexico: Wheat & Textiles",
      description: "NAFTA trade between Canada and Mexico in agriculture vs manufacturing",
      country1: {
        name: "Canada",
        good1: {name: "Wheat", production: 250},
        good2: {name: "Textiles", production: 80}
      },
      country2: {
        name: "Mexico", 
        good1: {name: "Wheat", production: 100},
        good2: {name: "Textiles", production: 200}
      },
      context: "Climate and labor cost advantages driving specialization",
      timeframe: "Annual output with same resource investments"
    },
    {
      title: "British Columbia vs. Quebec: Fish & Maple Syrup",
      description: "Regional specialization in Canadian natural resource production",
      country1: {
        name: "British Columbia",
        good1: {name: "Fish", production: 180},
        good2: {name: "Maple Syrup", production: 30}
      },
      country2: {
        name: "Quebec",
        good1: {name: "Fish", production: 40},
        good2: {name: "Maple Syrup", production: 150}
      },
      context: "Geographic and climate specialization within Canada",  
      timeframe: "Annual production with equivalent resource allocation"
    }
  ];

  let currentScenario = {};
  let currentQuestion = {};
  let totalCorrect = 0;
  let totalQuestions = 0;
  let hasAnswered = false;

  // Calculate opportunity costs and advantages
  function calculateAdvantages(scenario) {
    const c1 = scenario.country1;
    const c2 = scenario.country2;
    
    // Opportunity costs for country 1
    const c1_oc_good1 = (c1.good2.production / c1.good1.production).toFixed(2); // Units of good2 per good1
    const c1_oc_good2 = (c1.good1.production / c1.good2.production).toFixed(2); // Units of good1 per good2
    
    // Opportunity costs for country 2  
    const c2_oc_good1 = (c2.good2.production / c2.good1.production).toFixed(2);
    const c2_oc_good2 = (c2.good1.production / c2.good2.production).toFixed(2);
    
    // Absolute advantages
    const abs_adv_good1 = c1.good1.production > c2.good1.production ? c1.name : c2.name;
    const abs_adv_good2 = c1.good2.production > c2.good2.production ? c1.name : c2.name;
    
    // Comparative advantages (lower opportunity cost)
    const comp_adv_good1 = parseFloat(c1_oc_good1) < parseFloat(c2_oc_good1) ? c1.name : c2.name;
    const comp_adv_good2 = parseFloat(c1_oc_good2) < parseFloat(c2_oc_good2) ? c1.name : c2.name;
    
    return {
      c1_oc_good1, c1_oc_good2, c2_oc_good1, c2_oc_good2,
      abs_adv_good1, abs_adv_good2, comp_adv_good1, comp_adv_good2
    };
  }

  const questionTypes = [
    // ABSOLUTE ADVANTAGE QUESTIONS  
    {
      id: "absolute_advantage_identification",
      question: (scenario) => {
        const advantages = calculateAdvantages(scenario);
        const selectedGood = Math.random() < 0.5 ? scenario.country1.good1.name : scenario.country1.good2.name;
        const correctAnswer = selectedGood === scenario.country1.good1.name ? 
          advantages.abs_adv_good1 : advantages.abs_adv_good2;
        
        return {
          type: "multiple_choice",
          question: `Which country has an absolute advantage in ${selectedGood} production?`,
          options: [scenario.country1.name, scenario.country2.name, "Both countries", "Neither country"],
          correctAnswer: correctAnswer,
          explanation: `${correctAnswer} has absolute advantage in ${selectedGood} because it produces more ${selectedGood} with the same resources.`,
          hint: "Absolute advantage means producing MORE of a good with the same resources"
        };
      }
    },
    {
      id: "absolute_advantage_numbers",
      question: (scenario) => {
        const c1 = scenario.country1;
        const c2 = scenario.country2;
        const selectedGood = Math.random() < 0.5 ? c1.good1 : c1.good2;
        const c1Production = selectedGood.name === c1.good1.name ? c1.good1.production : c1.good2.production;
        const c2Production = selectedGood.name === c1.good1.name ? c2.good1.production : c2.good2.production;
        
        return {
          type: "input",
          question: `${c1.name} produces ${c1Production} units of ${selectedGood.name} while ${c2.name} produces ${c2Production} units. How many more units does the country with absolute advantage produce?`,
          correctAnswer: Math.abs(c1Production - c2Production),
          explanation: `The difference is ${Math.abs(c1Production - c2Production)} units, showing ${c1Production > c2Production ? c1.name : c2.name}'s absolute advantage in ${selectedGood.name}.`,
          hint: "Calculate the difference between the two production amounts"
        };
      }
    },

    // COMPARATIVE ADVANTAGE QUESTIONS
    {
      id: "comparative_advantage_identification", 
      question: (scenario) => {
        const advantages = calculateAdvantages(scenario);
        const selectedGood = Math.random() < 0.5 ? scenario.country1.good1.name : scenario.country1.good2.name;
        const correctAnswer = selectedGood === scenario.country1.good1.name ?
          advantages.comp_adv_good1 : advantages.comp_adv_good2;
        
        return {
          type: "multiple_choice",
          question: `Which country has a comparative advantage in ${selectedGood} production?`,
          options: [scenario.country1.name, scenario.country2.name, "Both countries", "Neither country"],
          correctAnswer: correctAnswer,
          explanation: `${correctAnswer} has comparative advantage in ${selectedGood} because it has the lower opportunity cost for producing ${selectedGood}.`,
          hint: "Comparative advantage means having a LOWER opportunity cost"
        };
      }
    },
    {
      id: "opportunity_cost_calculation",
      question: (scenario) => {
        const c1 = scenario.country1;
        const advantages = calculateAdvantages(scenario);
        const selectedGood = Math.random() < 0.5 ? c1.good1.name : c1.good2.name;
        const correctOC = selectedGood === c1.good1.name ? advantages.c1_oc_good1 : advantages.c1_oc_good2;
        const otherGood = selectedGood === c1.good1.name ? c1.good2.name : c1.good1.name;
        
        return {
          type: "input", 
          question: `What is ${c1.name}'s opportunity cost of producing 1 unit of ${selectedGood}? (Round to 2 decimal places)`,
          correctAnswer: parseFloat(correctOC),
          explanation: `${c1.name}'s opportunity cost is ${correctOC} units of ${otherGood} per unit of ${selectedGood}.`,
          hint: "Opportunity cost = What you give up √∑ What you gain"
        };
      }
    },
    {
      id: "opportunity_cost_comparison",
      question: (scenario) => {
        const advantages = calculateAdvantages(scenario);
        const c1 = scenario.country1;
        const c2 = scenario.country2;
        const selectedGood = Math.random() < 0.5 ? c1.good1.name : c1.good2.name;
        
        const c1_oc = selectedGood === c1.good1.name ? advantages.c1_oc_good1 : advantages.c1_oc_good2;
        const c2_oc = selectedGood === c1.good1.name ? advantages.c2_oc_good1 : advantages.c2_oc_good2;
        const otherGood = selectedGood === c1.good1.name ? c1.good2.name : c1.good1.name;
        
        return {
          type: "multiple_choice",
          question: `${c1.name}'s opportunity cost for ${selectedGood} is ${c1_oc} ${otherGood}. ${c2.name}'s is ${c2_oc} ${otherGood}. Which country should specialize in ${selectedGood}?`,
          options: [
            `${c1.name} (lower opportunity cost)`,
            `${c2.name} (lower opportunity cost)`, 
            "Both should produce equally",
            "Neither should specialize"
          ],
          correctAnswer: parseFloat(c1_oc) < parseFloat(c2_oc) ? 
            `${c1.name} (lower opportunity cost)` : `${c2.name} (lower opportunity cost)`,
          explanation: `${parseFloat(c1_oc) < parseFloat(c2_oc) ? c1.name : c2.name} should specialize in ${selectedGood} because it has the lower opportunity cost.`,
          hint: "The country with lower opportunity cost should specialize in that good"
        };
      }
    },

    // GAINS FROM TRADE QUESTIONS
    {
      id: "specialization_decision",
      question: (scenario) => {
        const advantages = calculateAdvantages(scenario);
        const c1 = scenario.country1;
        const c2 = scenario.country2;
        
        return {
          type: "multiple_choice",
          question: `Based on comparative advantage, how should these countries specialize?`,
          options: [
            `${c1.name} in ${c1.good1.name}, ${c2.name} in ${c1.good2.name}`,
            `${c1.name} in ${c1.good2.name}, ${c2.name} in ${c1.good1.name}`,
            "Both countries produce both goods equally",
            "No specialization needed"
          ],
          correctAnswer: advantages.comp_adv_good1 === c1.name ?
            `${c1.name} in ${c1.good1.name}, ${c2.name} in ${c1.good2.name}` :
            `${c1.name} in ${c1.good2.name}, ${c2.name} in ${c1.good1.name}`,
          explanation: `${advantages.comp_adv_good1} should specialize in ${c1.good1.name} and ${advantages.comp_adv_good2} should specialize in ${c1.good2.name} based on their comparative advantages.`,
          hint: "Each country specializes in the good where it has comparative advantage"
        };
      }
    },
    {
      id: "terms_of_trade",
      question: (scenario) => {
        const advantages = calculateAdvantages(scenario);
        const c1 = scenario.country1;
        
        // Terms of trade should be between the two opportunity costs
        const c1_oc = parseFloat(advantages.c1_oc_good1);
        const c2_oc = parseFloat(advantages.c2_oc_good1);
        const minTrade = Math.min(c1_oc, c2_oc);
        const maxTrade = Math.max(c1_oc, c2_oc);
        const midTrade = ((minTrade + maxTrade) / 2).toFixed(1);
        
        return {
          type: "multiple_choice",
          question: `If 1 ${c1.good1.name} trades for ${midTrade} ${c1.good2.name}, would this be beneficial for both countries?`,
          options: [
            "Yes, both countries benefit",
            "Only " + scenario.country1.name + " benefits",
            "Only " + scenario.country2.name + " benefits", 
            "Neither country benefits"
          ],
          correctAnswer: "Yes, both countries benefit",
          explanation: `The trade rate of ${midTrade} is between ${c1.name}'s opportunity cost (${c1_oc}) and ${scenario.country2.name}'s opportunity cost (${c2_oc}), so both countries benefit.`,
          hint: "Mutually beneficial trade occurs when the exchange rate is between both countries' opportunity costs"
        };
      }
    },
    {
      id: "trade_benefits",
      question: (scenario) => {
        return {
          type: "multiple_choice", 
          question: `What is the main reason both countries can benefit from trade even if one has absolute advantage in both goods?`,
          options: [
            "Comparative advantage allows specialization based on opportunity costs",
            "Absolute advantage guarantees mutual benefits", 
            "Transportation costs are eliminated",
            "Both countries have identical preferences"
          ],
          correctAnswer: "Comparative advantage allows specialization based on opportunity costs",
          explanation: "Even when one country has absolute advantage in both goods, comparative advantage based on different opportunity costs allows both to benefit from specialization and trade.",
          hint: "Think about the difference between absolute and comparative advantage"
        };
      }
    },

    // PRODUCTION AND CONSUMPTION POSSIBILITIES
    {
      id: "production_possibilities",
      question: (scenario) => {
        const c1 = scenario.country1;
        const totalProduction = c1.good1.production + c1.good2.production;
        
        return {
          type: "input",
          question: `If ${c1.name} uses all resources for ${c1.good1.name}, it produces ${c1.good1.production}. If it uses all for ${c1.good2.name}, it produces ${c1.good2.production}. What's the maximum total if it produces equal amounts of both?`,
          correctAnswer: Math.floor(totalProduction / 2),
          explanation: `With equal resource allocation, ${c1.name} could produce ${Math.floor(c1.good1.production/2)} ${c1.good1.name} and ${Math.floor(c1.good2.production/2)} ${c1.good2.name}, totaling ${Math.floor(totalProduction/2)} units.`,
          hint: "Divide resources equally between both goods and calculate total output"
        };
      }
    },
    {
      id: "consumption_expansion",
      question: (scenario) => {
        return {
          type: "multiple_choice",
          question: `Through specialization and trade, what happens to each country's consumption possibilities?`,
          options: [
            "Consumption possibilities remain the same as production possibilities",
            "Consumption possibilities expand beyond production possibilities",
            "Consumption possibilities shrink due to trade costs", 
            "Only the country with absolute advantage benefits"
          ],
          correctAnswer: "Consumption possibilities expand beyond production possibilities",
          explanation: "Specialization and trade allow countries to consume combinations of goods that exceed what they could produce in isolation, expanding consumption beyond the PPC.",
          hint: "Think about how trade allows consumption beyond what each country can produce alone"
        };
      }
    },

    // REAL-WORLD APPLICATIONS
    {
      id: "nafta_example",
      question: (scenario) => {
        if (scenario.title.includes("Mexico") || scenario.title.includes("United States")) {
          return {
            type: "multiple_choice",
            question: `NAFTA/USMCA trade agreements between Canada, US, and Mexico are based on which economic principle?`,
            options: [
              "Each country having absolute advantage in all goods",
              "Comparative advantage and specialization",
              "Equal production capabilities", 
              "Eliminating all opportunity costs"
            ],
            correctAnswer: "Comparative advantage and specialization",
            explanation: "NAFTA/USMCA allows countries to specialize based on comparative advantages, increasing overall efficiency and benefits for all members.",
            hint: "Think about the economic theory behind free trade agreements"
          };
        } else {
          return questionTypes[0].question(scenario);
        }
      }
    },
    {
      id: "resource_endowments",
      question: (scenario) => {
        return {
          type: "multiple_choice",
          question: `Why might Canada have comparative advantage in natural resource products?`,
          options: [
            "Canada has more skilled workers than other countries",
            "Canada has abundant natural resources relative to other factors",
            "Canada has lower wages than other countries",
            "Canada has better technology in all sectors"
          ],
          correctAnswer: "Canada has abundant natural resources relative to other factors",
          explanation: "Countries typically have comparative advantage in goods that use their abundant resources intensively - Canada's natural resource abundance gives it comparative advantage in resource-intensive products.",
          hint: "Consider what Canada has in abundance compared to other countries"
        };
      }
    },
    {
      id: "trade_policy_implications",
      question: (scenario) => {
        return {
          type: "multiple_choice",
          question: `If a country imposes tariffs on imports where it lacks comparative advantage, what's the likely result?`,
          options: [
            "Increased efficiency and lower prices",
            "Higher domestic prices and reduced efficiency",
            "Complete elimination of imports",
            "Automatic comparative advantage in those goods"
          ],
          correctAnswer: "Higher domestic prices and reduced efficiency", 
          explanation: "Tariffs on imports where the country lacks comparative advantage protect inefficient domestic producers, leading to higher prices and reduced overall efficiency.",
          hint: "Consider how trade barriers affect efficiency and prices"
        };
      }
    },

    // NUMERICAL APPLICATIONS  
    {
      id: "trade_quantity_calculation",
      question: (scenario) => {
        const advantages = calculateAdvantages(scenario);
        const c1 = scenario.country1;
        const exportGood = advantages.comp_adv_good1 === c1.name ? c1.good1.name : c1.good2.name;
        const exportProduction = advantages.comp_adv_good1 === c1.name ? c1.good1.production : c1.good2.production;
        const domesticConsumption = Math.floor(exportProduction * 0.6);
        
        return {
          type: "input",
          question: `If ${c1.name} specializes in ${exportGood} (${exportProduction} units) but consumes ${domesticConsumption} units domestically, how many units are available for export?`,
          correctAnswer: exportProduction - domesticConsumption,
          explanation: `${c1.name} has ${exportProduction - domesticConsumption} units available for export after domestic consumption.`,
          hint: "Subtract domestic consumption from total production"
        };
      }
    },
    {
      id: "comparative_advantage_strength",
      question: (scenario) => {
        const advantages = calculateAdvantages(scenario);
        const c1 = scenario.country1;
        const c1_oc = parseFloat(advantages.c1_oc_good1);
        const c2_oc = parseFloat(advantages.c2_oc_good1);
        
        return {
          type: "input",
          question: `${c1.name}'s opportunity cost for ${c1.good1.name} is ${c1_oc}. ${scenario.country2.name}'s is ${c2_oc}. By how much is the lower opportunity cost smaller? (Round to 2 decimal places)`,
          correctAnswer: parseFloat(Math.abs(c1_oc - c2_oc).toFixed(2)),
          explanation: `The difference in opportunity costs is ${Math.abs(c1_oc - c2_oc).toFixed(2)}, showing the strength of comparative advantage.`,
          hint: "Calculate the absolute difference between the two opportunity costs"
        };
      }
    }
  ];

  function generateQuestion() {
    const questionType = questionTypes[Math.floor(Math.random() * questionTypes.length)];
    currentQuestion = questionType.question(currentScenario);
    hasAnswered = false;
  }

  function startLearning() {
    // Select random scenario
    currentScenario = tradeScenarios[Math.floor(Math.random() * tradeScenarios.length)];
    
    generateQuestion();
    displayQuestion();
    
    // Show question card and relevant buttons
    document.getElementById("question-card").style.display = "block";
    document.getElementById("start-btn").classList.add("hidden");
    document.getElementById("show-explanation-btn").classList.remove("hidden");
    document.getElementById("check-answer-btn").classList.remove("hidden");
    document.getElementById("reset-btn").classList.remove("hidden");
    
    // Hide feedback initially
    document.getElementById("feedback-section").style.display = "none";
  }

  function displayQuestion() {
    // Update progress
    document.getElementById("progress").textContent = 
      `${currentScenario.title} ‚Ä¢ Question ${totalQuestions + 1} ‚Ä¢ Score: ${totalCorrect}/${totalQuestions} correct`;
    
    // Display question
    document.getElementById("question-text").innerHTML = `
      <strong>Trade Scenario:</strong> ${currentScenario.description}<br><br>
      <strong>Question:</strong> ${currentQuestion.question}
    `;

    // Display trade scenario data
    displayTradeScenario();
    
    // Create input area based on question type
    createInputArea();
    
    document.getElementById("warning").textContent = "";
    updateScoreDisplay();
  }

  function displayTradeScenario() {
    const scenarioDiv = document.getElementById("trade-scenario-display");
    const advantages = calculateAdvantages(currentScenario);
    
    let scenarioHTML = `
      <div class="scenario-box">
        <h4 style="text-align: center; color: #2c5282; margin-bottom: 15px;">üìä Trade Data Analysis</h4>
        <p><strong>Context:</strong> ${currentScenario.context}</p>
        <p><strong>Time Frame:</strong> ${currentScenario.timeframe}</p>
        
        <div class="trade-comparison">
          <div class="trade-scenario">
            <h5>${currentScenario.country1.name} Production Capacity:</h5>
            <table class="production-table">
              <thead>
                <tr>
                  <th>Good</th>
                  <th>Maximum Production</th>
                  <th>Opportunity Cost</th>
                </tr>
              </thead>
              <tbody>
                <tr class="${advantages.comp_adv_good1 === currentScenario.country1.name ? 'highlight-advantage' : ''}">
                  <td>${currentScenario.country1.good1.name}</td>
                  <td>${currentScenario.country1.good1.production}</td>
                  <td>${advantages.c1_oc_good1} ${currentScenario.country1.good2.name}</td>
                </tr>
                <tr class="${advantages.comp_adv_good2 === currentScenario.country1.name ? 'highlight-advantage' : ''}">
                  <td>${currentScenario.country1.good2.name}</td>
                  <td>${currentScenario.country1.good2.production}</td>
                  <td>${advantages.c1_oc_good2} ${currentScenario.country1.good1.name}</td>
                </tr>
              </tbody>
            </table>
          </div>
          
          <div class="trade-scenario">
            <h5>${currentScenario.country2.name} Production Capacity:</h5>
            <table class="production-table">
              <thead>
                <tr>
                  <th>Good</th>
                  <th>Maximum Production</th>
                  <th>Opportunity Cost</th>
                </tr>
              </thead>
              <tbody>
                <tr class="${advantages.comp_adv_good1 === currentScenario.country2.name ? 'highlight-advantage' : ''}">
                  <td>${currentScenario.country1.good1.name}</td>
                  <td>${currentScenario.country2.good1.production}</td>
                  <td>${advantages.c2_oc_good1} ${currentScenario.country1.good2.name}</td>
                </tr>
                <tr class="${advantages.comp_adv_good2 === currentScenario.country2.name ? 'highlight-advantage' : ''}">
                  <td>${currentScenario.country1.good2.name}</td>
                  <td>${currentScenario.country2.good2.production}</td>
                  <td>${advantages.c2_oc_good2} ${currentScenario.country1.good1.name}</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
        
        <div style="text-align: center; margin-top: 15px; padding: 10px; background: rgba(255,255,255,0.8); border-radius: 8px;">
          <p style="margin: 5px 0;"><strong>üèÜ Absolute Advantages:</strong> 
            ${currentScenario.country1.good1.name}: ${advantages.abs_adv_good1} | 
            ${currentScenario.country1.good2.name}: ${advantages.abs_adv_good2}</p>
          <p style="margin: 5px 0;"><strong>‚öñÔ∏è Comparative Advantages:</strong> 
            ${currentScenario.country1.good1.name}: ${advantages.comp_adv_good1} | 
            ${currentScenario.country1.good2.name}: ${advantages.comp_adv_good2}</p>
          <p style="font-size: 0.9em; color: #666; margin-top: 10px;">
            <span style="background: #d4edda; padding: 2px 6px; border-radius: 3px;">Green highlighting</span> shows comparative advantage
          </p>
        </div>
      </div>
    `;
    
    scenarioDiv.innerHTML = scenarioHTML;
  }

  function createInputArea() {
    const inputArea = document.getElementById("question-input-area");
    
    if (currentQuestion.type === "input") {
      inputArea.innerHTML = `
        <div style="text-align: center; margin: 20px 0;">
          <label for="answer-input" style="display: block; margin-bottom: 10px; font-weight: bold;">
            Your Answer:
          </label>
          <input type="number" id="answer-input" class="input-field" step="0.01" 
                 placeholder="Enter number" style="width: 150px; font-size: 1.1em;">
        </div>
      `;
    } else if (currentQuestion.type === "multiple_choice") {
      let optionsHTML = '<div class="options">';
      currentQuestion.options.forEach((option, index) => {
        optionsHTML += `
          <label>
            <input type="radio" name="answer" value="${option}"> ${option}
          </label>
        `;
      });
      optionsHTML += '</div>';
      inputArea.innerHTML = optionsHTML;
    }
  }

  function updateScoreDisplay() {
    const scoreDiv = document.getElementById("score-display");
    if (totalQuestions > 0) {
      const percentage = Math.round((totalCorrect / totalQuestions) * 100);
      scoreDiv.innerHTML = `üìä Your Progress: ${totalCorrect}/${totalQuestions} correct (${percentage}%)`;
      scoreDiv.style.display = "block";
    }
  }

  function showExplanation() {
    const feedbackSection = document.getElementById("feedback-section");
    
    document.getElementById("feedback-header").textContent = "üí° Hint";
    document.getElementById("feedback-explanation").innerHTML = `
      <strong>How to approach this question:</strong><br>
      ${currentQuestion.hint}
    `;
    document.getElementById("feedback-details").innerHTML = `
      <strong>Remember:</strong> Look at the production data and opportunity costs to understand trade relationships and comparative advantages.
    `;
    
    feedbackSection.className = "";
    feedbackSection.style.display = "block";
    feedbackSection.style.background = "#e3f2fd";
    feedbackSection.style.border = "3px solid #2196f3";
    feedbackSection.style.color = "#1565c0";
  }

  function checkAnswer() {
    if (hasAnswered) {
      document.getElementById("warning").textContent = 
        "You've already answered this question. Click 'Next Question' to continue.";
      return;
    }

    let userAnswer;
    let isCorrect = false;

    if (currentQuestion.type === "input") {
      const input = document.getElementById("answer-input");
      if (!input.value.trim()) {
        document.getElementById("warning").textContent = 
          "‚ö†Ô∏è Please enter your answer before checking.";
        return;
      }
      userAnswer = parseFloat(input.value);
      isCorrect = Math.abs(userAnswer - currentQuestion.correctAnswer) < 0.01;
    } else if (currentQuestion.type === "multiple_choice") {
      const selected = document.querySelector('input[name="answer"]:checked');
      if (!selected) {
        document.getElementById("warning").textContent = 
          "‚ö†Ô∏è Please select an option before checking your answer.";
        return;
      }
      userAnswer = selected.value;
      isCorrect = userAnswer === currentQuestion.correctAnswer;
    }

    // Update statistics
    totalQuestions++;
    if (isCorrect) totalCorrect++;
    hasAnswered = true;

    // Show feedback
    showFeedback(isCorrect, userAnswer);
    
    // Update UI
    document.getElementById("next-btn").classList.remove("hidden");
    document.getElementById("check-answer-btn").classList.add("hidden");
    updateScoreDisplay();
    document.getElementById("warning").textContent = "";
  }

  function showFeedback(isCorrect, userAnswer) {
    const feedbackSection = document.getElementById("feedback-section");
    const feedbackHeader = document.getElementById("feedback-header");
    const feedbackExplanation = document.getElementById("feedback-explanation");
    const feedbackDetails = document.getElementById("feedback-details");

    if (isCorrect) {
      feedbackSection.className = "feedback-correct";
      feedbackHeader.innerHTML = "üéâ Excellent!";
      feedbackExplanation.innerHTML = `
        <strong>Perfect!</strong> You correctly answered: <strong>${userAnswer}</strong><br><br>
        ${currentQuestion.explanation}
      `;
      feedbackDetails.innerHTML = `
        <strong>Great trade analysis!</strong> You understand these international trade concepts well.
      `;
    } else {
      feedbackSection.className = "feedback-incorrect";
      feedbackHeader.innerHTML = "üìö Let's Learn Together";
      feedbackExplanation.innerHTML = `
        You answered: <strong>${userAnswer}</strong><br>
        The correct answer is: <strong>${currentQuestion.correctAnswer}</strong><br><br>
        <strong>Explanation:</strong><br>
        ${currentQuestion.explanation}
      `;
      feedbackDetails.innerHTML = `
        <strong>Learning tip:</strong> Review the production data and opportunity cost calculations. Practice identifying which country has lower opportunity costs for each good.
      `;
    }

    feedbackSection.style.display = "block";
  }

  function nextQuestion() {
    generateQuestion();
    displayQuestion();
    
    // Reset UI state
    document.getElementById("feedback-section").style.display = "none";
    document.getElementById("check-answer-btn").classList.remove("hidden");
    document.getElementById("next-btn").classList.add("hidden");
    document.getElementById("warning").textContent = "";
  }

  function resetLearning() {
    // Reset statistics
    totalCorrect = 0;
    totalQuestions = 0;
    hasAnswered = false;

    // Reset UI
    document.getElementById("question-card").style.display = "none";
    document.getElementById("feedback-section").style.display = "none";
    document.getElementById("score-display").style.display = "none";
    
    // Reset buttons
    document.getElementById("start-btn").classList.remove("hidden");
    document.getElementById("show-explanation-btn").classList.add("hidden");
    document.getElementById("check-answer-btn").classList.add("hidden");
    document.getElementById("next-btn").classList.add("hidden");
    document.getElementById("reset-btn").classList.add("hidden");
    
    document.getElementById("warning").textContent = "";
  }
</script>
</body>
</html>
